!function(){function e(e){this.isMobile=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i),this.isMobile&&(e.autoplay=!1);var a={element:document.getElementsByClassName("aplayer")[0],narrow:!1,autoplay:!1,showlrc:!1,theme:"#72e6cf",bgcolor:"#7d7f95",style:"style1"};for(var t in a)a.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=a[t]);this.playIndex="[object Array]"===Object.prototype.toString.call(e.music)?0:-1,this.option=e,this.audios=[],this.loop=!0}e.prototype.init=function(){function e(e){var a=e||window.event,s=(a.clientX-t(n.bar))/o;s=s>0?s:0,s=1>s?s:1,n.updateBar.call(n,"played",s,"width"),n.option.showlrc&&n.updateLrc.call(n,parseFloat(n.playedBar.style.width)/100*n.audio.duration),n.element.getElementsByClassName("aplayer-ptime")[0].innerHTML=n.secondToTime(s*n.audio.duration)}function a(){document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",e),n.audio.currentTime=parseFloat(n.playedBar.style.width)/100*n.audio.duration,n.play()}function t(e){for(var a,t=e.offsetLeft,s=e.offsetParent;null!==s;)t+=s.offsetLeft,s=s.offsetParent;return a=document.body.scrollLeft+document.documentElement.scrollLeft,t-a}function s(e){for(var a,t=e.offsetTop,s=e.offsetParent;null!==s;)t+=s.offsetTop,s=s.offsetParent;return a=document.body.scrollTop+document.documentElement.scrollTop,t-a}this.element=this.option.element,this.music=this.playIndex>-1?this.option.music[this.playIndex]:this.option.music;var l;if(this.option.showlrc){var i=[];for(l=0;l<this.element.getElementsByClassName("aplayer-lrc-content").length;l++)i.push(this.element.getElementsByClassName("aplayer-lrc-content")[l].innerHTML);this.lrcs=this.parseLrc(i)}if(this.option.narrow)var r="<style>.crazyplayer-narrow1-wrap .crazyplayer-narrow1-inner {background-color:"+this.option.bgcolor+'}</style><div class="crazyplayer-narrow1-wrap"><div class="crazyplayer-narrow1-inner"><div class="aplayer-pic"></div><div class="crazyplayer-narrow1-control"><div class="crazyplayer-narrow1-control-left"><div class="aplayer-button aplayer-play"><i class="demo-icon aplayer-icon-play"></i></div><span class="aplayer-ptime">00:00</span><span class="aplayer-dtime">00:00</span></div><div class="crazyplayer-narrow1-control-right"><div class="aplayer-time"><div class="aplayer-volume-wrap"><i class="demo-icon aplayer-icon-volume-down"></i><div class="aplayer-volume-bar-wrap"><div class="aplayer-volume-bar"><div class="aplayer-volume" style="height: 80%; background: '+this.option.theme+';"></div></div></div></div></div><i class="demo-icon aplayer-icon-loop"></i></div></div><div class="crazyplayer-narrow1-info"><span class="aplayer-title"></span><span class="aplayer-author"></span></div></div><div class="aplayer-info"><div class="aplayer-lrc"><div class="aplayer-lrc-contents" style="transform: translateY(0); -webkit-transform: translateY(0);"></div></div><div class="aplayer-controller"><div class="aplayer-bar-wrap"><div class="aplayer-bar"><div class="aplayer-loaded" style="width: 0; background: '+this.option.theme+'; opacity:.4"></div><div class="aplayer-played" style="width: 0; background: '+this.option.theme+';"><span class="aplayer-thumb"></span></div></div></div></div></div></div>';else if("style2"==this.option.style)var r="<style>.crazyplayer-style1-wrap, .crazyplayer-style1-list .aplayer-list {background-color:"+this.option.bgcolor+"}.crazyplayer-style1-wrap .aplayer-loaded, .crazyplayer-style1-list .aplayer-list-light, .crazyplayer-style1-wrap .aplayer-button.aplayer-play, .crazyplayer-style1-wrap .aplayer-button.aplayer-pause {background-color:"+this.option.theme+"}.crazyplayer-style1-wrap .demo-icon.aplayer-icon-volume-down, .crazyplayer-style1-wrap .demo-icon.aplayer-icon-loop, .crazyplayer-style1-wrap .demo-icon.aplayer-icon-menu{color:"+this.option.theme+'}</style><div class="crazyplayer-style1-wrap"><div class="crazyplayer-style1-inner" style="background-color: '+this.option.bgcolor+'"><div class="aplayer-pic"></div><i class="demo-icon aplayer-icon-loop"></i><div class="aplayer-time"><div class="aplayer-volume-wrap"><i class="demo-icon aplayer-icon-volume-down"></i><div class="aplayer-volume-bar-wrap"><div class="aplayer-volume-bar"><div class="aplayer-volume" style="height: 80%; background: '+this.option.theme+';"></div></div></div></div></div><div class="aplayer-playlist-icon">'+(this.playIndex>-1?'<i class="demo-icon aplayer-icon-menu"></i>':"")+'</div><div class="crazyplayer-style1-info"><span class="aplayer-title"></span><span class="aplayer-author"></span></div><div class="crazyplayer-style-1-controllers"><div class="crazyplayer-style-1-remaining"><span class="aplayer-ptime">00:00</span></div><div class="crazyplayer-style-1-play-volume"><div class="aplayer-button aplayer-play"><i class="demo-icon aplayer-icon-play"></i></div></div><div class="crazyplayer-style-1-endtime"><span class="aplayer-dtime">00:00</span></div></div></div><div class="aplayer-info"><div class="aplayer-lrc"><div class="aplayer-lrc-contents" style="transform: translateY(0); -webkit-transform: translateY(0);"></div></div><div class="aplayer-controller"><div class="aplayer-bar-wrap"><div class="aplayer-bar"><div class="aplayer-loaded" style="width: 0; background: '+this.option.theme+'; opacity:.4"></div><div class="aplayer-played" style="width: 0; background: '+this.option.theme+';"><span class="aplayer-thumb"></span></div></div></div></div></div></div>';else var r="<style>.crazyplayer-style2-wrap, .crazyplayer-style2-list .aplayer-list {background-color:"+this.option.bgcolor+"}.crazyplayer-style2-wrap .aplayer-loaded, .crazyplayer-style2-list .aplayer-list-light {background-color:"+this.option.theme+"}.crazyplayer-style2-wrap .demo-icon.aplayer-icon-volume-down, .crazyplayer-style2-wrap .demo-icon.aplayer-icon-loop, .crazyplayer-style2-wrap .demo-icon.aplayer-icon-menu{color:"+this.option.theme+'}</style><div class="crazyplayer-style2-wrap"><div class="aplayer-pic"></div><div class="crazyplayer-style2-right-content"><div class="crazyplayer-style2-right-inner"><div class="crazyplayer-style2-info"><span class="aplayer-title"></span><span class="aplayer-author"></span></div><div class="crazyplayer-style-2-bar"><div class="aplayer-bar-wrap"><div class="aplayer-bar"><div class="aplayer-loaded" style="width: 0"></div><div class="aplayer-played" style="width: 0; background: '+this.option.theme+';"><span class="aplayer-thumb"></span></div></div></div></div><div class="crazyplayer-style-2-songinfo"><div class="crazyplayer-style-2-songinfo-left"><div class="crazyplayer-style-1-play-volume"><div class="aplayer-button aplayer-play"><i class="demo-icon aplayer-icon-play"></i></div></div></div><div class="crazyplayer-style-2-songinfo-right"><span class="aplayer-ptime">00:00</span><div class="aplayer-time"><span class="aplayer-dtime">00:00</span><div class="aplayer-volume-wrap"><i class="demo-icon aplayer-icon-volume-down"></i><div class="aplayer-volume-bar-wrap"><div class="aplayer-volume-bar"><div class="aplayer-volume" style="height: 80%; background: '+this.option.theme+';"></div></div></div></div><i class="demo-icon aplayer-icon-loop"></i>'+(this.playIndex>-1?'<i class="demo-icon aplayer-icon-menu"></i>':"")+"</div></div></div></div></div></div>";if(r+="style2"==this.option.style?'<div class="crazyplayer-style1-list">':'<div class="crazyplayer-style2-list">',this.playIndex>-1){for(r+='<div class="aplayer-list"><ol>',l=0;l<this.option.music.length;l++)r+='<li><span class="aplayer-list-cur" style="background: '+this.option.theme+';"></span><span class="aplayer-list-index">'+(l+1)+'</span><span class="aplayer-list-title">'+this.option.music[l].title+'</span><span class="aplayer-list-author">'+this.option.music[l].author+"</span></li>";r+="</ol></div>"}r+="</div>",this.element.innerHTML=r,this.option.narrow&&this.element.classList.add("aplayer-narrow");var n=this;if(this.button=this.element.getElementsByClassName("aplayer-button")[0],this.button.addEventListener("click",function(){this.classList.contains("aplayer-play")?n.play.call(n):this.classList.contains("aplayer-pause")&&n.pause.call(n)}),this.playIndex>-1)for(l=0;l<this.option.music.length;l++)this.element.getElementsByClassName("aplayer-list")[0].getElementsByTagName("li")[l].addEventListener("click",function(){var e=parseInt(this.getElementsByClassName("aplayer-list-index")[0].innerHTML)-1;e!==n.playIndex&&n.setMusic(e),n.play()});this.playedBar=this.element.getElementsByClassName("aplayer-played")[0],this.loadedBar=this.element.getElementsByClassName("aplayer-loaded")[0],this.thumb=this.element.getElementsByClassName("aplayer-thumb")[0],this.bar=this.element.getElementsByClassName("aplayer-bar")[0];var o;this.bar.addEventListener("click",function(e){var a=e||window.event;o=n.bar.clientWidth;var s=(a.clientX-t(n.bar))/o;n.updateBar.call(n,"played",s,"width"),n.element.getElementsByClassName("aplayer-ptime")[0].innerHTML=n.secondToTime(s*n.audio.duration),n.audio.currentTime=parseFloat(n.playedBar.style.width)/100*n.audio.duration}),this.thumb.addEventListener("mouseover",function(){this.style.background=n.option.theme}),this.thumb.addEventListener("mouseout",function(){this.style.background="#fff"}),this.thumb.addEventListener("mousedown",function(){o=n.bar.clientWidth,clearInterval(n.playedTime),document.addEventListener("mousemove",e),document.addEventListener("mouseup",a)}),this.volumeBar=this.element.getElementsByClassName("aplayer-volume")[0];var p=this.element.getElementsByClassName("aplayer-volume-bar")[0],d=n.element.getElementsByClassName("aplayer-time")[0].getElementsByTagName("i")[0],c=35;this.element.getElementsByClassName("aplayer-volume-bar-wrap")[0].addEventListener("click",function(e){var a=e||window.event,t=(c-a.clientY+s(p))/c;t=t>0?t:0,t=1>t?t:1,n.updateBar.call(n,"volume",t,"height"),n.audio.volume=t,n.audio.muted&&(n.audio.muted=!1),1===t?d.className="demo-icon aplayer-icon-volume-up":d.className="demo-icon aplayer-icon-volume-down"}),d.addEventListener("click",function(){n.audio.muted?(n.audio.muted=!1,d.className=1===n.audio.volume?"demo-icon aplayer-icon-volume-up":"demo-icon aplayer-icon-volume-down",n.updateBar.call(n,"volume",n.audio.volume,"height")):(n.audio.muted=!0,d.className="demo-icon aplayer-icon-volume-off",n.updateBar.call(n,"volume",0,"height"))}),this.element.getElementsByClassName("aplayer-icon-loop")[0].addEventListener("click",function(){n.loop?(this.classList.add("aplayer-noloop"),n.loop=!1,n.audio.loop=n.playIndex>-1?!1:n.loop):(this.classList.remove("aplayer-noloop"),n.loop=!0,n.audio.loop=n.playIndex>-1?!1:n.loop)}),this.playIndex>-1&&this.element.getElementsByClassName("aplayer-icon-menu")[0].addEventListener("click",function(){var e=n.element.getElementsByClassName("aplayer-list")[0];e.classList.contains("aplayer-list-hide")?(e.classList.remove("aplayer-list-hide"),this.classList.remove("aplayer-list-hide-icon")):(e.classList.add("aplayer-list-hide"),this.classList.add("aplayer-list-hide-icon"))}),this.setMusic(0)},e.prototype.setMusic=function(e){this.playIndex>-1&&"undefined"!=typeof arguments[0]&&(this.playIndex=arguments[0]);var a=this.playIndex;if(this.music=this.playIndex>-1?this.option.music[a]:this.option.music,this.music.pic&&(this.element.getElementsByClassName("aplayer-pic")[0].style.backgroundImage="url("+encodeURI(this.music.pic)+")"),this.element.getElementsByClassName("aplayer-title")[0].innerHTML=this.music.title,this.element.getElementsByClassName("aplayer-author")[0].innerHTML=" - "+this.music.author,this.playIndex>-1&&(this.element.getElementsByClassName("aplayer-list-light")[0]&&this.element.getElementsByClassName("aplayer-list-light")[0].classList.remove("aplayer-list-light"),this.element.getElementsByClassName("aplayer-list")[0].getElementsByTagName("li")[a].classList.add("aplayer-list-light")),this.audio&&(this.pause(),this.audio.currentTime=0),this.playIndex>-1&&!this.audios[a]||-1===this.playIndex){this.audio=document.createElement("audio"),this.audio.src=this.music.url,this.audio.preload=this.isMobile?"none":"metadata";var t=this;this.audio.addEventListener("durationchange",function(){1!==t.audio.duration&&(t.element.getElementsByClassName("aplayer-dtime")[0].innerHTML=t.secondToTime(t.audio.duration))}),t.audio.addEventListener("progress",function(){var e=t.audio.buffered.length?t.audio.buffered.end(t.audio.buffered.length-1)/t.audio.duration:0;t.updateBar.call(t,"loaded",e,"width")}),this.audio.addEventListener("error",function(){t.element.getElementsByClassName("aplayer-author")[0].innerHTML=" - Error happens ╥﹏╥"}),this.playIndex>-1?this.audio.addEventListener("ended",function(){t.playIndex<t.option.music.length-1?t.setMusic(++t.playIndex):t.loop?t.setMusic(0):t.loop||t.pause()}):this.audio.addEventListener("ended",function(){t.loop||t.pause()}),this.audio.volume=parseInt(this.element.getElementsByClassName("aplayer-volume")[0].style.height)/100,this.audio.loop=this.playIndex>-1?!1:this.loop,this.playIndex>-1&&(this.audios[a]=this.audio)}else this.audio=this.audios[a],this.audio.volume=parseInt(this.element.getElementsByClassName("aplayer-volume")[0].style.height)/100,this.audio.currentTime=0;if(this.option.showlrc){this.lrc=this.playIndex>-1?this.lrcs[a]:this.lrcs[0],this.element.classList.add("aplayer-withlrc");var s="";this.lrcContents=this.element.getElementsByClassName("aplayer-lrc-contents")[0];for(var l=0;l<this.lrc.length;l++)s+="<p>"+this.lrc[l][1]+"</p>";this.lrcContents.innerHTML=s,this.lrcIndex||(this.lrcIndex=0),this.lrcContents.getElementsByTagName("p")[0].classList.add("aplayer-lrc-current"),this.lrcContents.style.transform="translateY(0px)",this.lrcContents.style.webkitTransform="translateY(0px)"}1!==this.audio.duration&&(this.element.getElementsByClassName("aplayer-dtime")[0].innerHTML=this.audio.duration?this.secondToTime(this.audio.duration):"00:00"),this.option.autoplay&&!this.isMobile&&this.play(),this.option.autoplay=!0,this.isMobile&&this.pause()},e.prototype.play=function(){var e=this;this.button.classList.remove("aplayer-play"),this.button.classList.add("aplayer-pause"),this.button.innerHTML="",setTimeout(function(){e.button.innerHTML='<i class="demo-icon aplayer-icon-pause"></i>'},100),this.audio.play(),this.playedTime&&clearInterval(this.playedTime),this.playedTime=setInterval(function(){e.updateBar.call(e,"played",e.audio.currentTime/e.audio.duration,"width"),e.option.showlrc&&e.updateLrc.call(e),e.element.getElementsByClassName("aplayer-ptime")[0].innerHTML=e.secondToTime(e.audio.currentTime)},100)},e.prototype.pause=function(){var e=this;this.button.classList.remove("aplayer-pause"),this.button.classList.add("aplayer-play"),this.button.innerHTML="",setTimeout(function(){e.button.innerHTML='<i class="demo-icon aplayer-icon-play"></i>'},100),this.audio.pause(),clearInterval(this.playedTime)},e.prototype.updateBar=function(e,a,t){a=a>0?a:0,a=1>a?a:1,this[e+"Bar"].style[t]=100*a+"%"},e.prototype.updateLrc=function(e){if("undefined"==typeof arguments[0]&&(e=this.audio.currentTime),this.lrcIndex>this.lrc.length-1||e<this.lrc[this.lrcIndex][0]||!this.lrc[this.lrcIndex+1]||e>=this.lrc[this.lrcIndex+1][0])for(var a=0;a<this.lrc.length;a++)e>=this.lrc[a][0]&&(!this.lrc[a+1]||e<this.lrc[a+1][0])&&(this.lrcIndex=a,this.lrcContents.style.transform="translateY("+20*-this.lrcIndex+"px)",this.lrcContents.style.webkitTransform="translateY("+20*-this.lrcIndex+"px)",this.lrcContents.getElementsByClassName("aplayer-lrc-current")[0].classList.remove("aplayer-lrc-current"),this.lrcContents.getElementsByTagName("p")[a].classList.add("aplayer-lrc-current"))},e.prototype.secondToTime=function(e){var a=function(e){return 10>e?"0"+e:""+e},t=parseInt(e/60),s=parseInt(e-60*t);return a(t)+":"+a(s)},e.prototype.parseLrc=function(e){for(var a=[],t=0;t<e.length;t++){for(var s=e[t].split("\n"),l=[],i=s.length,r=0;i>r;r++){var n=s[r].match(/\[(\d{2}):(\d{2})\.(\d{2,3})]/g),o=s[r].replace(/\[(\d{2}):(\d{2})\.(\d{2,3})]/g,"").replace(/^\s+|\s+$/g,"");if(null!=n)for(var p=n.length,d=0;p>d;d++){var c=/\[(\d{2}):(\d{2})\.(\d{2,3})]/.exec(n[d]),y=60*c[1]+parseInt(c[2])+parseInt(c[3])/(2===(c[3]+"").length?100:1e3);l.push([y,o])}}l.sort(function(e,a){return e[0]-a[0]}),a.push(l)}return a},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:window.APlayer=e}();